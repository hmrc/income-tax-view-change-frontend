@*
 * Copyright 2020 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import java.time.LocalDate

@import implicits.ImplicitDateFormatter._
@import models.core.breadcrumb.{Breadcrumb, BreadcrumbItem}
@import views.html.templates.main_template
@import views.html.helpers.breadcrumbHelper

@(nextPaymentDueDate: Option[LocalDate], nextUpdate: LocalDate, paymentEnabled: Boolean)(implicit request: Request[_], messages: Messages, appConfig: config.FrontendAppConfig, user: auth.MtdItUser[_])

@breadcrumb = {
    @breadcrumbHelper(Breadcrumb(Vector(
        BreadcrumbItem("breadcrumb-it", None)
    )), "HomePage")
}

@paymentsTile = {
    <div id="payments-tile" class="tile tile-no-border">
        <div class="tile-body">
            <h2 class="heading-medium">@messages("home.payments.heading")</h2>
            <p>@nextPaymentDueDate.map(_.toLongDate).getOrElse(messages("home.payments.no-payments-due"))</p>
            <p><a href=@controllers.routes.PaymentDueController.viewPaymentsDue().url>@messages("home.payments.view")</a></p>
        </div>
    </div>
}

@updatesTile = {
    <div id="updates-tile" class="tile tile-no-border">
        <div class="tile-body">
            <h2 class="heading-medium">@messages("home.updates.heading")</h2>
            <p>@nextUpdate.toLongDate</p>
            <p><a href=@controllers.routes.ReportDeadlinesController.getReportDeadlines().url>@messages("home.updates.view")</a></p>
        </div>
    </div>
}

@taxYearsTile = {
    <div id="tax-years-tile" class="tile tile-no-border">
        <div class="tile-body">
            <h2 class="heading-medium">@messages("home.tax-years.heading")</h2>
            <p>@messages("home.tax-years.description")</p>
            <p><a href=@controllers.routes.EstimatesController.viewEstimateCalculations().url>@messages("home.tax-years.view")</a></p>
        </div>
    </div>
}

@main_template(
    title = messages("home.title"),
    mainClass = Some("full-width"),
    contentHeader = Some(breadcrumb)
) {

    <h1 class="heading-xlarge">
        <span id="income-tax-heading">@messages("home.heading")</span>
        <span id="sub-heading" class="heading-secondary">@user.userDetails.map(_.name)</span>
    </h1>

    <span id="utr-reference-heading" class="form-hint heading-xl-addon">
        @messages("home.unique.taxpayer.reference", user.mtditid)
    </span>

    <div class="flex-container grid-row">

        @if(paymentEnabled) {
            @paymentsTile
        }
        @updatesTile
        @taxYearsTile

    </div>

}

